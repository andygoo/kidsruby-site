webshims.register("mediaelement-yt",function(e,t,a,i,r){"use strict";var n=t.mediaelement,o=e.Deferred();a.onYouTubePlayerAPIReady=function(){o.resolve()},a.YT&&YT.Player&&a.onYouTubePlayerAPIReady();var d={paused:!0,ended:!1,currentSrc:"",duration:a.NaN,readyState:0,networkState:0,videoHeight:0,videoWidth:0,error:null,buffered:{start:function(e){return e?(t.error("buffered index size error"),r):0},end:function(e){return e?(t.error("buffered index size error"),r):0},length:0}},u=Object.keys(d),l={currentTime:0,volume:1,muted:!1};Object.keys(l);var s=e.extend({isActive:"html5",activating:"html5",wasSwfReady:!1,_metadata:!1,_callMeta:!1,currentTime:0,_buffered:0,_ppFlag:r},d,l),h=function(t,a){a=e.Event(a),a.preventDefault(),e.event.trigger(a,r,t)},c=function(){var e=["_buffered","_metadata","_ppFlag","currentSrc","currentTime","duration","ended","networkState","paused","videoHeight","videoWidth","_callMeta"],t=e.length;return function(a){if(a){var i=t,r=a.networkState;for(a.readyState=0;--i;)delete a[e[i]];a.buffered.length=0,clearInterval(a._timeInterval),r&&h(a._elem,"emptied")}}}(),m=function(){var t={},a=function(a){var r,n,o;return t[a.currentSrc]?r=t[a.currentSrc]:a.videoHeight&&a.videoWidth?(t[a.currentSrc]={width:a.videoWidth,height:a.videoHeight},r=t[a.currentSrc]):(n=e.attr(a._elem,"poster"))&&(r=t[n],r||(o=i.createElement("img"),o.onload=function(){t[n]={width:this.width,height:this.height},t[n].height&&t[n].width?f(a):delete t[n]},o.src=n,o.complete&&o.onload())),r||{width:300,height:"video"==a._elemNodeName?150:50}};return function(t){var i,r,n=t.elemDimensions;return("auto"==n.width||"auto"==n.height)&&(n=e.extend({},t.elemDimensions),i=a(t),r=i.width/i.height,"auto"==n.width&&"auto"==n.height?n=i:"auto"==n.width?(t.shadowElem.css({height:n.height}),n.width=t.shadowElem.height()*r):(t.shadowElem.css({width:n.width}),n.height=t.shadowElem.width()/r)),n}}(),f=function(t){var i,r=t._elem,n=t.shadowElem;"third"==t.isActive&&(t&&t._ytAPI&&t._ytAPI.getPlaybackQuality&&(a.ytapi=t._ytAPI),t.elemDimensions={width:r.style.width||e.attr(r,"width")||e(r).width(),height:r.style.height||e.attr(r,"height")||e(r).height()},i=m(t),i.minWidth=r.style.minWidth,i.minHeight=r.style.minHeight,n.css(i))},g=function(e){try{e.nodeName}catch(a){return null}var i=t.data(e,"mediaelement");return i&&"third"==i.isActive?i:null},p=function(a){var i;return a=a.split("?"),-1!=a[0].indexOf("youtube.com/watch")&&a[1]?(a=a[1].split("&"),e.each(a,function(e,t){return t=t.split("="),"v"==t[0]?(a=t[1],i=!0,!1):r})):-1!=a[0].indexOf("youtube.com/v/")&&(a=a[0].split("/"),e.each(a,function(e,t){return i?(a=t,!1):("v"==t&&(i=!0),r)})),i||t.warn("no youtube id found: "+a),a},v=function(t){t&&(t._ppFlag===r&&e.prop(t._elem,"autoplay")||!t.paused)&&setTimeout(function(){if("third"==t.isActive&&(t._ppFlag===r||!t.paused))try{e(t._elem).play()}catch(a){}},1)},y=e.noop;!function(){var a={play:1,playing:1},r=["play","pause","playing","canplay","progress","waiting","ended","loadedmetadata","durationchange","emptied"],n=r.map(function(e){return e+".webshimspolyfill"}).join(" "),o=function(i){var r=t.data(i.target,"mediaelement");if(r){var n=i.originalEvent&&i.originalEvent.type===i.type;n==("third"==r.activating)&&(i.stopImmediatePropagation(),a[i.type]&&r.isActive!=r.activating&&e(i.target).pause())}};(y=function(a){e(a).off(n).on(n,o),r.forEach(function(e){t.moveToFirstEvent(a,e)})})(i)}(),e(i).on("emptied",function(e){var t=g(e.target);v(t)}),n.setActive=function(a,i,r){if(r||(r=t.data(a,"mediaelement")),r&&r.isActive!=i){"html5"!=i&&"third"!=i&&t.warn("wrong type for mediaelement activating: "+i);var n=t.data(a,"shadowData");r.activating=i,e(a).pause(),r.isActive=i,"third"==i?(n.shadowElement=n.shadowFocusElement=r.shadowElem[0],e(a).addClass("yt-api-active nonnative-api-active").hide().getShadowElement().show()):(clearInterval(r._timeInterval),e(a).removeClass("yt-api-active nonnative-api-active").show().getShadowElement().hide(),n.shadowElement=n.shadowFocusElement=!1),e(a).trigger("mediaelementapichange")}};var w=function(t,a){a._ppFlag=!0,"playing"==t&&(w("play",a),3>a.readyState&&(a.readyState=3,h(a._elem,"canplay")),e(a._elem).trigger("playing")),"play"==t&&a.paused?(a.paused=!1,h(a._elem,"play")):"pause"!=t||a.paused||(a.paused=!0,h(a._elem,"pause"))},_={small:{height:240,width:320},medium:{height:360,width:640},large:{height:480,width:853},hd720:{height:720,width:1280},hd1080:{height:1080,width:1920}},I=function(t,a,i,r){o.done(function(){var n=function(){var a,r;i._metadata&&i._ytAPI.getVideoLoadedFraction&&(r=i._ytAPI.getVideoLoadedFraction(),a=r*i.duration,i._buffered!==a&&(i._buffered=a,i.buffered.length=1,e(t).trigger("progress")),r>.99&&(i.networkState=1),4>i.readyState&&i.currentTime&&(i._buffered-i.currentTime>9||r>.9)&&(i.readyState=4,h(i._elem,"canplaythrough")))},o=function(){if(i._ytAPI&&i._ytAPI.getCurrentTime){var a=i._ytAPI.getCurrentTime();i.currentTime!=a&&(i.currentTime=a,e(t).trigger("timeupdate")),n()}},d=function(){if("third"==i.isActive&&i._ytAPI&&i._ytAPI.getVolume){var a,r=i._ytAPI.getVolume()/100,d=i._ytAPI.isMuted();r!=i.volume&&(i.volume=r,a=!0),d!=i.muted&&(i.muted=d,a=!0),o(),n(),a&&e(t).trigger("volumechange")}},u=function(){clearInterval(i._timeInterval),i._timeInterval=setInterval(function(){var a=i._ytAPI.getCurrentTime();i.currentTime!=a&&(i.currentTime=a,e(t).trigger("timeupdate"))},350)};i._ytAPI=new YT.Player(a,{height:"100%",width:"100%",allowfullscreen:"allowfullscreen",webkitallowfullscreen:"allowfullscreen",playerVars:{allowfullscreen:!0,fs:1,rel:0,showinfo:0,autohide:1,controls:e.prop(t,"controls")?1:0},videoId:r,events:{onReady:function(){v(i),setTimeout(d,9),setInterval(d,5e3)},onStateChange:function(a){if(a.target.getDuration){var r;if(!i._metadata){var n=a.target.getDuration(),o=a.target.getPlaybackQuality();n&&(i._metadata=!0,i.duration=n,1>i.readyState&&(i.readyState=1),1>i.networkState&&(i.networkState=2),r=!0,_[o]||(o="large"),i.videoHeight=_[o].height,i.videoWidth=_[o].width)}r&&e(t).trigger("durationchange").trigger("loadedmetadata"),setTimeout(d,9),1==a.data?(w("playing",i),u()):2==a.data?(clearInterval(i._timeInterval),w("pause",i)):3==a.data?(i.readyState>2&&(i.readyState=2),i.networkState=2,e(t).trigger("waiting")):0===a.data&&(i.readyState>4&&(i.readyState=4),i.networkState=1,clearInterval(i._timeInterval),e(t).trigger("ended"))}}}}),e(t).on("updateytdata",d)})};if("matchMedia"in a){var A=!1;try{A=a.matchMedia("only all").matches}catch(P){}A&&(n.sortMedia=function(e,t){return e=!e.media||matchMedia(e.media).matches,t=!t.media||matchMedia(t.media).matches,e==t?0:e?-1:1})}n.createSWF=function(a,i,d){d||(d=t.data(a,"mediaelement"));var u="yt-"+t.getID(a),l=p(i.src),h=e.prop(a,"controls");if(d)return n.setActive(a,"third",d),c(d),d.currentSrc=i.srcProp,h!=d._hasControls?(d.shadowElem.html('<div id="'+u+'">'),I(a,u,d,l)):o.done(function(){d._ytAPI.cueVideoByUrl&&d._ytAPI.cueVideoByUrl(l)}),d._hasControls=h,r;var m=e('<div class="polyfill-video polyfill-mediaelement" id="wrapper-'+u+'"><div id="'+u+'"></div>').css({position:"relative",overflow:"hidden"}),g=function(){f(d)};d=t.data(a,"mediaelement",t.objectCreate(s,{shadowElem:{value:m},_elem:{value:a},_hasControls:{value:h},currentSrc:{value:i.srcProp},buffered:{value:{start:function(e){return e>=d.buffered.length?(t.error("buffered index size error"),r):0},end:function(e){return e>=d.buffered.length?(t.error("buffered index size error"),r):d._buffered},length:0}}})),f(d),t.addShadowDom(a,m),n.setActive(a,"third",d),y(a),m.insertBefore(a),I(a,u,d,l),e(a).on("updatemediaelementdimensions loadedmetadata emptied",g).onWSOff("updateshadowdom",g)},function(){var a,i=function(t){clearTimeout(t.updateDataTimer),t.updateDataTimer=setTimeout(function(){e(t._elem).triggerHandler("updateytdata")},9)},n={},o=function(e){n[e]={get:function(){var t=g(this);return t?t[e]:a[e].prop._supget.apply(this)},writeable:!1}},d=function(e,t){o(e),delete n[e].writeable,n[e].set=t};u.forEach(o),d("currentTime",function(e){var t=g(this);return t?(e*=1,!isNaN(e)&&t._ytAPI&&t._ytAPI.seekTo&&(t._ytAPI.seekTo(e),i(t)),r):a.currentTime.prop._supset.apply(this,arguments)}),d("muted",function(e){var t=g(this);return t?(t._ytAPI&&t._ytAPI.mute&&(t._ytAPI[e?"mute":"unMute"](),i(t)),r):a.muted.prop._supset.apply(this,arguments)}),d("volume",function(e){var n=g(this);return n?(e*=100,!isNaN(e)&&n._ytAPI&&n._ytAPI.setVolume&&((0>e||e>100)&&t.error("volume greater or less than allowed "+e/100),n._ytAPI.setVolume(e),i(n)),r):a.volume.prop._supset.apply(this,arguments)}),e.each(["play","pause"],function(e,t){var i=t+"Video";n[t]={value:function(){var e=g(this);return e?(e._ytAPI&&e._ytAPI[i]&&(e._ytAPI[i](),w(t,e)),r):a[t].prop._supvalue.apply(this,arguments)}}}),a=t.defineNodeNameProperties("video",n,"prop"),t.onNodeNamesPropertyModify("video","controls",function(t,a){var i=g(this);e(this)[a?"addClass":"removeClass"]("webshims-controls"),i&&i._ytAPI&&!i.readyState&&e(this).mediaLoad()})}()});