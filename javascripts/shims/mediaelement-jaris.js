webshims.register("mediaelement-jaris",function(e,t,a,i,r,n){"use strict";var o=t.mediaelement,d=a.swfmini,u=Modernizr.audio&&Modernizr.video,s=d.hasFlashPlayerVersion("9.0.115"),l=0,m="ActiveXObject"in a&&u,c={paused:!0,ended:!1,currentSrc:"",duration:a.NaN,readyState:0,networkState:0,videoHeight:0,videoWidth:0,seeking:!1,error:null,buffered:{start:function(e){return e?(t.error("buffered index size error"),r):0},end:function(e){return e?(t.error("buffered index size error"),r):0},length:0}},p=Object.keys(c),h={currentTime:0,volume:1,muted:!1};Object.keys(h);var f=e.extend({isActive:"html5",activating:"html5",wasSwfReady:!1,_bufferedEnd:0,_bufferedStart:0,currentTime:0,_ppFlag:r,_calledMeta:!1,lastDuration:0},c,h),v=function(e){try{e.nodeName}catch(a){return null}var i=t.data(e,"mediaelement");return i&&"third"==i.isActive?i:null},g=function(t,a){a=e.Event(a),a.preventDefault(),e.event.trigger(a,r,t)},y=n.playerPath||t.cfg.basePath+"swf/"+(n.playerName||"JarisFLVPlayer.swf");t.extendUNDEFProp(n.params,{allowscriptaccess:"always",allowfullscreen:"true",wmode:"transparent",allowNetworking:"all"}),t.extendUNDEFProp(n.vars,{controltype:"1",jsapi:"1"}),t.extendUNDEFProp(n.attrs,{bgcolor:"#000000"});var _=function(e,t){3>e&&clearTimeout(t._canplaythroughTimer),e>=3&&3>t.readyState&&(t.readyState=e,g(t._elem,"canplay"),t.paused||g(t._elem,"playing"),clearTimeout(t._canplaythroughTimer),t._canplaythroughTimer=setTimeout(function(){_(4,t)},4e3)),e>=4&&4>t.readyState&&(t.readyState=e,g(t._elem,"canplaythrough")),t.readyState=e},w=function(t){t.seeking&&2>Math.abs(t.currentTime-t._lastSeektime)&&(t.seeking=!1,e(t._elem).triggerHandler("seeked"))};o.jarisEvent={};var T,E={onPlayPause:function(e,t,a){var i,r;if(null==a)try{i=t.api.api_get("isPlaying")}catch(n){}else i=a;i==t.paused&&(t.paused=!i,r=t.paused?"pause":"play",t._ppFlag=!0,g(t._elem,r),3>t.readyState&&_(3,t),t.paused||g(t._elem,"playing"))},onSeek:function(t,a){a._lastSeektime=t.seekTime,a.seeking=!0,e(a._elem).triggerHandler("seeking"),clearTimeout(a._seekedTimer),a._seekedTimer=setTimeout(function(){w(a),a.seeking=!1},300)},onConnectionFailed:function(){t.error("media error")},onNotBuffering:function(e,t){_(3,t)},onDataInitialized:function(e,t){var a,i=t.duration;t.duration=e.duration,i==t.duration||isNaN(t.duration)||t._calledMeta&&2>(a=Math.abs(t.lastDuration-t.duration))||(t.videoHeight=e.height,t.videoWidth=e.width,t.networkState||(t.networkState=2),1>t.readyState&&_(1,t),clearTimeout(t._durationChangeTimer),t._calledMeta&&t.duration?t._durationChangeTimer=setTimeout(function(){t.lastDuration=t.duration,g(t._elem,"durationchange")},a>50?0:a>9?9:99):(t.lastDuration=t.duration,t.duration&&g(t._elem,"durationchange"),t._calledMeta||g(t._elem,"loadedmetadata")),t._calledMeta=!0)},onBuffering:function(e,t){t.ended&&(t.ended=!1),_(1,t),g(t._elem,"waiting")},onTimeUpdate:function(e,t){t.ended&&(t.ended=!1),3>t.readyState&&(_(3,t),g(t._elem,"playing")),t.seeking&&w(t),g(t._elem,"timeupdate")},onProgress:function(t,a){if(a.ended&&(a.ended=!1),a.duration&&!isNaN(a.duration)){var i=t.loaded/t.total;i>.02&&.2>i?_(3,a):i>.2&&(i>.99&&(a.networkState=1),_(4,a)),a._bufferedEnd&&a._bufferedEnd>i&&(a._bufferedStart=a.currentTime||0),a._bufferedEnd=i,a.buffered.length=1,e.event.trigger("progress",r,a._elem,!0)}},onPlaybackFinished:function(e,t){4>t.readyState&&_(4,t),t.ended=!0,g(t._elem,"ended")},onVolumeChange:function(e,t){(t.volume!=e.volume||t.muted!=e.mute)&&(t.volume=e.volume,t.muted=e.mute,g(t._elem,"volumechange"))},ready:function(){var a=function(e){var t=!0;try{e.api.api_get("volume")}catch(a){t=!1}return t};return function(i,n){var o=0,d=function(){return o>9?(n.tryedReframeing=0,r):(o++,n.tryedReframeing++,a(n)?(n.wasSwfReady=!0,n.tryedReframeing=0,b(n),N(n)):6>n.tryedReframeing?3>n.tryedReframeing?(n.reframeTimer=setTimeout(d,9),n.shadowElem.css({overflow:"visible"}),setTimeout(function(){n.shadowElem.css({overflow:"hidden"})},1)):(n.shadowElem.css({overflow:"hidden"}),e(n._elem).mediaLoad()):(clearTimeout(n.reframeTimer),t.error("reframing error")),r)};n&&n.api&&(n.tryedReframeing||(n.tryedReframeing=0),clearTimeout(T),clearTimeout(n.reframeTimer),n.shadowElem.removeClass("flashblocker-assumed"),o?n.reframeTimer=setTimeout(d,9):d())}}()};E.onMute=E.onVolumeChange;var N=function(e){var a,i=e.actionQueue.length,r=0;if(i&&"third"==e.isActive)for(;e.actionQueue.length&&i>r;){r++,a=e.actionQueue.shift();try{e.api[a.fn].apply(e.api,a.args)}catch(n){t.warn(n)}}e.actionQueue.length&&(e.actionQueue=[])},b=function(t){t&&((t._ppFlag===r&&e.prop(t._elem,"autoplay")||!t.paused)&&setTimeout(function(){if("third"==t.isActive&&(t._ppFlag===r||!t.paused))try{e(t._elem).play(),t._ppFlag=!0}catch(a){}},1),t.muted&&e.prop(t._elem,"muted",!0),1!=t.volume&&e.prop(t._elem,"volume",t.volume))},S=e.noop;if(u){var k={play:1,playing:1},P=["play","pause","playing","canplay","progress","waiting","ended","loadedmetadata","durationchange","emptied"],A=P.map(function(e){return e+".webshimspolyfill"}).join(" "),D=function(a){var i=t.data(a.target,"mediaelement");if(i){var r=a.originalEvent&&a.originalEvent.type===a.type;r==("third"==i.activating)&&(a.stopImmediatePropagation(),k[a.type]&&(i.isActive!=i.activating?e(a.target).pause():r&&(e.prop(a.target,"pause")._supvalue||e.noop).apply(a.target)))}};(S=function(a){e(a).off(A).on(A,D),P.forEach(function(e){t.moveToFirstEvent(a,e)})})(i)}o.setActive=function(a,i,r){if(r||(r=t.data(a,"mediaelement")),r&&r.isActive!=i){"html5"!=i&&"third"!=i&&t.warn("wrong type for mediaelement activating: "+i);var n=t.data(a,"shadowData");r.activating=i,e(a).pause(),r.isActive=i,"third"==i?(n.shadowElement=n.shadowFocusElement=r.shadowElem[0],e(a).addClass("swf-api-active nonnative-api-active").hide().getShadowElement().show()):(e(a).removeClass("swf-api-active nonnative-api-active").show().getShadowElement().hide(),n.shadowElement=n.shadowFocusElement=!1),e(a).trigger("mediaelementapichange")}};var C=function(){var e=["_calledMeta","lastDuration","_bufferedEnd","_bufferedStart","_ppFlag","currentSrc","currentTime","duration","ended","networkState","paused","seeking","videoHeight","videoWidth"],t=e.length;return function(a){if(a){clearTimeout(a._seekedTimer);var i=t,r=a.networkState;for(_(0,a),clearTimeout(a._durationChangeTimer);--i>-1;)delete a[e[i]];a.actionQueue=[],a.buffered.length=0,r&&g(a._elem,"emptied")}}}(),M=function(){var t={},a=function(a){var r,n,o;return t[a.currentSrc]?r=t[a.currentSrc]:a.videoHeight&&a.videoWidth?(t[a.currentSrc]={width:a.videoWidth,height:a.videoHeight},r=t[a.currentSrc]):(n=e.attr(a._elem,"poster"))&&(r=t[n],r||(o=i.createElement("img"),o.onload=function(){t[n]={width:this.width,height:this.height},t[n].height&&t[n].width?F(a,e.prop(a._elem,"controls")):delete t[n]},o.src=n,o.complete&&o.onload())),r||{width:300,height:"video"==a._elemNodeName?150:50}};return function(t){var i,r,n=t.elemDimensions;return("auto"==n.width||"auto"==n.height)&&(n=e.extend({},t.elemDimensions),i=a(t),r=i.width/i.height,"auto"==n.width&&"auto"==n.height?n=i:"auto"==n.width?(t.shadowElem.css({height:n.height}),n.width=t.shadowElem.height()*r):(t.shadowElem.css({width:n.width}),n.height=t.shadowElem.width()/r)),n}}(),F=function(t,a){var i,r=t._elem,n=t.shadowElem;e(r)[a?"addClass":"removeClass"]("webshims-controls"),"third"==t.isActive&&("audio"!=t._elemNodeName||a?(t.elemDimensions={width:r.style.width||e.attr(r,"width")||e(r).width(),height:r.style.height||e.attr(r,"height")||e(r).height()},i=M(t),i.minWidth=r.style.minWidth,i.minHeight=r.style.minHeight,n.css(i)):n.css({width:0,height:0}))},x=function(){var t={"":1,auto:1};return function(a){var i=e.attr(a,"preload");return null==i||"none"==i||e.prop(a,"autoplay")?!1:(i=e.prop(a,"preload"),!!(t[i]||"metadata"==i&&e(a).is(".preload-in-doubt, video:not([poster])")))}}(),H={A:/&amp;/g,a:/&/g,e:/\=/g,q:/\?/g},W=function(e){return e.replace?e.replace(H.A,"%26").replace(H.a,"%26").replace(H.e,"%3D").replace(H.q,"%3F"):e};if("matchMedia"in a){var j=!1;try{j=a.matchMedia("only all").matches}catch(R){}j&&(o.sortMedia=function(e,t){try{e=!e.media||matchMedia(e.media).matches,t=!t.media||matchMedia(t.media).matches}catch(a){return 0}return e==t?0:e?-1:1})}o.createSWF=function(a,m,c){if(!s)return setTimeout(function(){e(a).mediaLoad()},1),r;1>l?l=1:l++,c||(c=t.data(a,"mediaelement")),(e.attr(a,"height")||e.attr(a,"width"))&&t.warn("width or height content attributes used. Webshims prefers the usage of CSS (computed styles or inline styles) to detect size of a video/audio. It's really more powerfull.");var p,h="audio/rtmp"==m.type||"video/rtmp"==m.type,v=e.extend({},n.vars,{poster:W(e.attr(a,"poster")&&e.prop(a,"poster")||""),source:W(m.streamId||m.srcProp),server:W(m.server||"")}),g=e(a).data("vars")||{},_=e.prop(a,"controls"),w="jarisplayer-"+t.getID(a),N=e.extend({},n.params,e(a).data("params")),b=a.nodeName.toLowerCase(),k=e.extend({},n.attrs,{name:w,id:w},e(a).data("attrs")),P=function(){"third"==c.isActive&&F(c,e.prop(a,"controls"))};return c&&c.swfCreated?(o.setActive(a,"third",c),c.currentSrc=m.srcProp,c.shadowElem.html('<div id="'+w+'">'),c.api=!1,c.actionQueue=[],p=c.shadowElem,C(c)):(e(i.getElementById("wrapper-"+w)).remove(),p=e('<div class="polyfill-'+b+' polyfill-mediaelement" id="wrapper-'+w+'"><div id="'+w+'"></div>').css({position:"relative",overflow:"hidden"}),c=t.data(a,"mediaelement",t.objectCreate(f,{actionQueue:{value:[]},shadowElem:{value:p},_elemNodeName:{value:b},_elem:{value:a},currentSrc:{value:m.srcProp},swfCreated:{value:!0},id:{value:w.replace(/-/g,"")},buffered:{value:{start:function(e){return e>=c.buffered.length?(t.error("buffered index size error"),r):0},end:function(e){return e>=c.buffered.length?(t.error("buffered index size error"),r):(c.duration-c._bufferedStart)*c._bufferedEnd+c._bufferedStart},length:0}}})),p.insertBefore(a),u&&e.extend(c,{volume:e.prop(a,"volume"),muted:e.prop(a,"muted"),paused:e.prop(a,"paused")}),t.addShadowDom(a,p),t.data(a,"mediaelement")||t.data(a,"mediaelement",c),S(a),o.setActive(a,"third",c),F(c,_),e(a).on({"updatemediaelementdimensions loadedmetadata emptied":P,remove:function(e){!e.originalEvent&&o.jarisEvent[c.id]&&o.jarisEvent[c.id].elem==a&&(delete o.jarisEvent[c.id],clearTimeout(T),clearTimeout(c.flashBlock))}}).onWSOff("updateshadowdom",P)),o.jarisEvent[c.id]&&o.jarisEvent[c.id].elem!=a?(t.error("something went wrong"),r):(o.jarisEvent[c.id]||(o.jarisEvent[c.id]=function(e){if("ready"==e.type){var t=function(){c.api&&(x(a)&&c.api.api_preload(),E.ready(e,c))};c.api?t():setTimeout(t,9)}else c.currentTime=e.position,c.api&&(!c._calledMeta&&isNaN(e.duration)&&c.duration!=e.duration&&isNaN(c.duration)&&E.onDataInitialized(e,c),c._ppFlag||"onPlayPause"==e.type||E.onPlayPause(e,c),E[e.type]&&E[e.type](e,c)),c.duration=e.duration},o.jarisEvent[c.id].elem=a),e.extend(v,{id:w,evtId:c.id,controls:""+_,autostart:"false",nodename:b},g),h?v.streamtype="rtmp":"audio/mpeg"==m.type||"audio/mp3"==m.type?(v.type="audio",v.streamtype="file"):"video/youtube"==m.type&&(v.streamtype="youtube"),n.changeSWF(v,a,m,c,"embed"),clearTimeout(c.flashBlock),d.embedSWF(y,w,"100%","100%","9.0.115",!1,v,N,k,function(i){if(i.success){var r=function(){(!i.ref.parentNode&&p[0].parentNode||"none"==i.ref.style.display)&&(p.addClass("flashblocker-assumed"),e(a).trigger("flashblocker"),t.warn("flashblocker assumed")),e(i.ref).css({minHeight:"2px",minWidth:"2px",display:"block"})};c.api=i.ref,_||e(i.ref).attr("tabindex","-1").css("outline","none"),c.flashBlock=setTimeout(r,99),T||(clearTimeout(T),T=setTimeout(function(){r();var a=e(i.ref);a[0].offsetWidth>1&&a[0].offsetHeight>1&&0===location.protocol.indexOf("file:")?t.error("Add your local development-directory to the local-trusted security sandbox:  http://www.macromedia.com/support/documentation/en/flashplayer/help/settings_manager04.html"):(2>a[0].offsetWidth||2>a[0].offsetHeight)&&t.warn("JS-SWF connection can't be established on hidden or unconnected flash objects"),a=null},8e3))}}),r)};var O=function(e,t,a,i){return i=i||v(e),i?(i.api&&i.api[t]?i.api[t].apply(i.api,a||[]):(i.actionQueue.push({fn:t,args:a}),i.actionQueue.length>10&&setTimeout(function(){i.actionQueue.length>5&&i.actionQueue.shift()},99)),i):!1};if(["audio","video"].forEach(function(a){var i,r={},n=function(e){("audio"!=a||"videoHeight"!=e&&"videoWidth"!=e)&&(r[e]={get:function(){var t=v(this);return t?t[e]:u&&i[e].prop._supget?i[e].prop._supget.apply(this):f[e]},writeable:!1})},o=function(e,t){n(e),delete r[e].writeable,r[e].set=t};o("seeking"),o("volume",function(e){var a=v(this);if(a)e*=1,isNaN(e)||((0>e||e>1)&&t.error("volume greater or less than allowed "+e/100),O(this,"api_volume",[e],a),a.volume!=e&&(a.volume=e,g(a._elem,"volumechange")),a=null);else if(i.volume.prop._supset)return i.volume.prop._supset.apply(this,arguments)}),o("muted",function(e){var t=v(this);if(t)e=!!e,O(this,"api_muted",[e],t),t.muted!=e&&(t.muted=e,g(t._elem,"volumechange")),t=null;else if(i.muted.prop._supset)return i.muted.prop._supset.apply(this,arguments)}),o("currentTime",function(e){var t=v(this);if(t)e*=1,isNaN(e)||O(this,"api_seek",[e],t);else if(i.currentTime.prop._supset)return i.currentTime.prop._supset.apply(this,arguments)}),["play","pause"].forEach(function(e){r[e]={value:function(){var t=v(this);if(t)t.stopPlayPause&&clearTimeout(t.stopPlayPause),O(this,"play"==e?"api_play":"api_pause",[],t),t._ppFlag=!0,t.paused!=("play"!=e)&&(t.paused="play"!=e,g(t._elem,e));else if(i[e].prop._supvalue)return i[e].prop._supvalue.apply(this,arguments)}}}),p.forEach(n),t.onNodeNamesPropertyModify(a,"controls",function(t,i){var r=v(this);e(this)[i?"addClass":"removeClass"]("webshims-controls"),r&&("audio"==a&&F(r,i),O(this,"api_controls",[i],r))}),t.onNodeNamesPropertyModify(a,"preload",function(){var a,i,r;x(this)&&(a=v(this),a?O(this,"api_preload",[],a):!m||!this.paused||this.error||e.data(this,"mediaerror")||this.readyState||this.networkState||this.autoplay||!e(this).is(":not(.nonnative-api-active)")||(r=this,i=t.data(r,"mediaelementBase")||t.data(r,"mediaelementBase",{}),clearTimeout(i.loadTimer),i.loadTimer=setTimeout(function(){e(r).mediaLoad()},9)))}),i=t.defineNodeNameProperties(a,r,"prop"),Modernizr.mediaDefaultMuted||t.defineNodeNameProperties(a,{defaultMuted:{get:function(){return null!=e.attr(this,"muted")},set:function(t){t?e.attr(this,"muted",""):e(this).removeAttr("muted")}}},"prop")}),s&&e.cleanData){var B=e.cleanData,Q={object:1,OBJECT:1};e.cleanData=function(e){var t,a;if(e&&(a=e.length)&&l)for(t=0;a>t;t++)if(Q[e[t].nodeName]&&"api_pause"in e[t]){l--;try{e[t].api_pause()}catch(i){}}return B.apply(this,arguments)}}u?"media"in i.createElement("source")||t.reflectProperties("source",["media"]):(["poster","src"].forEach(function(e){t.defineNodeNamesProperty("src"==e?["audio","video","source"]:["video"],e,{reflect:!0,propType:"src"})}),t.defineNodeNamesProperty(["audio","video"],"preload",{reflect:!0,propType:"enumarated",defaultValue:"",limitedTo:["","auto","metadata","none"]}),t.reflectProperties("source",["type","media"]),["autoplay","controls"].forEach(function(e){t.defineNodeNamesBooleanProperty(["audio","video"],e)}),t.defineNodeNamesProperties(["audio","video"],{HAVE_CURRENT_DATA:{value:2},HAVE_ENOUGH_DATA:{value:4},HAVE_FUTURE_DATA:{value:3},HAVE_METADATA:{value:1},HAVE_NOTHING:{value:0},NETWORK_EMPTY:{value:0},NETWORK_IDLE:{value:1},NETWORK_LOADING:{value:2},NETWORK_NO_SOURCE:{value:3}},"prop")),n.experimentallyMimetypeCheck&&function(){var t=e.fn.addBack?"addBack":"andSelf",a=function(){var a,i="media/unknown please provide mime type",r=e(this),n=[];r.not(".ws-after-check").find("source")[t]().filter("[data-wsrecheckmimetype]:not([type])").each(function(){var t=e(this).removeAttr("data-wsrecheckmimetype"),r=function(){t.attr("data-type",i)};try{n.push(e.ajax({type:"head",url:e.attr(this,"src"),success:function(e,r,n){var o=n.getResponseHeader("Content-Type");o&&(a=!0),t.attr("data-type",o||i)},error:r}))}catch(o){r()}}),n.length&&(r.addClass("ws-after-check"),e.when.apply(e,n).always(function(){r.mediaLoad(),setTimeout(function(){r.removeClass("ws-after-check")},9)}))};e("audio.media-error, video.media-error").each(a),e(i).on("mediaerror",function(e){a.call(e.target)})}()});